function [cubR,cubS,cubW, Ncub] = Cubature2D(Corder)

% function [cubR,cubS,cubW, Ncub] = Cubature2D(Corder)
% Purpose: provide multidimensional quadrature (i.e. cubature) 
%          rules to integrate up to Corder polynomials
     
CubatureData2D;

if(Corder<=28)
  cubR = cub2D{Corder}(:,1);
  cubS = cub2D{Corder}(:,2);
  cubW = cub2D{Corder}(:,3); 
else
  cubNA = ceil( (Corder+1)/2);
  [cubA,cubWA] = JacobiGQ(0,0, cubNA-1);
  cubNB = ceil( (Corder+1)/2);
  [cubB,cubWB] = JacobiGQ(1,0, cubNB-1);
  
  cubA = ones(cubNB,1)*cubA';
  cubB = cubB*ones(1,cubNA);

  cubR = 0.5*(1+cubA).*(1-cubB)-1;
  cubS = cubB;
  cubW = 0.5*cubWB*(cubWA');

  cubR = cubR(:);
  cubS = cubS(:);
  cubW = cubW(:);
end
Ncub = length(cubW(:));


if(Corder == 15)
  cubR=[-7.400435401338439e-01, 4.800870802676880e-01,-7.400435401338448e-01,-3.333333333333335e-01,-7.984610140588057e-02,-7.984610140588078e-02,-8.403077971882387e-01,-6.353564331856176e-01, 4.661679902212335e-01,-8.308115570356159e-01, 4.661679902212341e-01,-6.353564331856174e-01,-8.308115570356163e-01,-6.995992318695226e-01, 6.675450522968325e-01,-9.679458204273088e-01, 6.675450522968314e-01,-6.995992318695218e-01,-9.679458204273091e-01,-3.537773696725746e-01, 1.584764848120903e-01,-8.046991151395153e-01, 1.584764848120894e-01,-3.537773696725753e-01,-8.046991151395160e-01,-1.662836673940549e-02,-1.662836673940549e-02,-9.667432665211896e-01,-5.569353184097162e-01, 1.138706368194319e-01,-5.569353184097163e-01,-2.061325251818791e-01,-2.061325251818784e-01,-5.877349496362430e-01,-3.841046370326544e-01, 3.471961332233881e-01,-9.630914961907334e-01, 3.471961332233875e-01,-3.841046370326544e-01,-9.630914961907340e-01,-8.873161646077987e-01, 7.746323292155998e-01,-8.873161646077999e-01,-9.239295413977817e-01, 9.217024708497537e-01,-9.977729294519746e-01, 9.217024708497543e-01,-9.239295413977837e-01,-9.977729294519724e-01];
  cubS=[-7.400435401338441e-01,-7.400435401338441e-01, 4.800870802676895e-01,-3.333333333333330e-01,-8.403077971882390e-01,-7.984610140588050e-02,-7.984610140588050e-02,-8.308115570356165e-01,-6.353564331856172e-01, 4.661679902212336e-01,-8.308115570356165e-01, 4.661679902212347e-01,-6.353564331856172e-01,-9.679458204273088e-01,-6.995992318695230e-01, 6.675450522968317e-01,-9.679458204273088e-01, 6.675450522968317e-01,-6.995992318695220e-01,-8.046991151395149e-01,-3.537773696725746e-01, 1.584764848120905e-01,-8.046991151395149e-01, 1.584764848120905e-01,-3.537773696725741e-01,-9.667432665211890e-01,-1.662836673940493e-02,-1.662836673940493e-02,-5.569353184097156e-01,-5.569353184097156e-01, 1.138706368194324e-01,-5.877349496362417e-01,-2.061325251818791e-01,-2.061325251818781e-01,-9.630914961907331e-01,-3.841046370326544e-01, 3.471961332233888e-01,-9.630914961907331e-01, 3.471961332233889e-01,-3.841046370326539e-01,-8.873161646078005e-01,-8.873161646077995e-01, 7.746323292155999e-01,-9.977729294519726e-01,-9.239295413977813e-01, 9.217024708497589e-01,-9.977729294519726e-01, 9.217024708497589e-01,-9.239295413977813e-01];
  cubW=[1.479500813409226e-02, 1.479500813409226e-02, 1.479500813409226e-02, 5.946083949614261e-02, 4.318817587287694e-02, 4.318817587287694e-02, 4.318817587287694e-02, 4.846001756625122e-02, 4.846001756625122e-02, 4.846001756625122e-02, 4.846001756625122e-02, 4.846001756625122e-02, 4.846001756625122e-02, 2.245700859775617e-02, 2.245700859775617e-02, 2.245700859775617e-02, 2.245700859775617e-02, 2.245700859775617e-02, 2.245700859775617e-02, 6.215044094102191e-02, 6.215044094102191e-02, 6.215044094102191e-02, 6.215044094102191e-02, 6.215044094102191e-02, 6.215044094102191e-02, 3.166455270004361e-02, 3.166455270004361e-02, 3.166455270004361e-02, 9.257457221039617e-02, 9.257457221039617e-02, 9.257457221039617e-02, 9.267208278241446e-02, 9.267208278241446e-02, 9.267208278241446e-02, 3.287352418565583e-02, 3.287352418565583e-02, 3.287352418565583e-02, 3.287352418565583e-02, 3.287352418565583e-02, 3.287352418565583e-02, 3.016894849519410e-02, 3.016894849519410e-02, 3.016894849519410e-02, 4.950532029115839e-03, 4.950532029115839e-03, 4.950532029115839e-03, 4.950532029115839e-03, 4.950532029115839e-03, 4.950532029115839e-03];
  cubR = cubR(:);
  cubS = cubS(:);
  cubW = cubW(:);
end
Ncub = length(cubW(:));

return
